// THE CHAIN : A PURE-SASS FRAMEWORK FOR RESPONSIVE WEBSITES.
// Copyright (C) 2013-2018 by W. Anthony Ellison.
//
// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or (at
// your option) any later version.
//
// This program is distributed in the hope that it will be useful, but
// WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
// General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with this program.  If not, see <http://www.gnu.org/licenses/>.

///////////////////////////////////////////////////////////////////////////////
// Typography module.
///////////////////////////////////////////////////////////////////////////////

// We define the usual suspects wrt type families: sans, serif, and mono.  We
// also define the preferred styles for headings, body text, and navigational
// elements.
//
// Helvetica/Arial/Droid Sans and Times/Times New Roman/Droid Serif are our
// safe fallbacks and cover macOS/iOS, Android, Windows, and Mac.  (They also
// cover a goodly number of Linux installs, though Liberation Sans/Serif would
// cover more of those.)
$chain-sans: "Helvetica Neue", "Arial", sans-serif;
$chain-serif: "Cormorant Garamond", "Georgia", serif;
$chain-mono: "Source Code Pro", monospace;

$chain-body-face: $chain-serif;
$chain-heading-face: $chain-serif;
$chain-element-face: $chain-serif;

// Base size of all text.  This is the root for every other size of text within
// the Chain framework.
$chain-basesize: 15pt;

// This is the base line height multiplier, set to 1.5x or (with the usual
// 15pt base font size) 25pt.
$chain-basemult: 1.666667;

// This mixin sets the line height of its parent element to the specified size,
// which is the base font size times the line height multiplier.
@mixin base-line-height($size) {
  line-height: $size * $chain-basemult;
}

// Heading text sizes.  First-level headings are defined as being 180% the
// size of body text.
$chain-h1: 1.8      * $chain-basesize; // 27 pt
$chain-h2: 1.6      * $chain-basesize; // 24 pt
$chain-h3: 1.4      * $chain-basesize; // 21 pt
$chain-h4: 1.2      * $chain-basesize; // 18 pt
$chain-h5: 1.066667 * $chain-basesize; // 16 pt
$chain-h6:            $chain-basesize; // 15pt

// Small elements.  Small element sizes are also declared in multiples of
// the base size, with the smallest at 2/3 the size of body text.
$chain-sm: 0.8      * $chain-basesize;
$chain-vs: 0.666667 * $chain-basesize; // 10pt

@mixin the-font-size($size) {
  font-size:   $size;
  @include base-line-height($size);
}

// The optimizeLegibility setting has a bug on very old Chrome versions:
// it doesn't mix with `text-transform: small-caps`.  This setting
// brings forth ligatures like `fi` and `fl`, provided your typeface
// supports them.  Fixed in a newer version of Harfbuzz, via:
// https://bugs.chromium.org/p/chromium/issues/detail?id=51973
* {
  text-rendering: optimizeLegibility;
  color: $chain-black;
}

// 2017 update:
// Recent Firefox, MSIE, MSEdge, Safari, and Mobile Safari support
// hyphenation on relevant platforms.  It must be prefixed on IE, Edge,
// and both Mac and Mobile Safari, but no longer on Firefox.
// See <http://caniuse.com/#search=hyphenation> for particulars.
blockquote p, p, li, dd, dt, caption {
  @include prefixer(hyphens, auto, webkit ms moz);
  @include prefixer(hyphenate-limit-chars, 7 3 3, ms);
  @include prefixer(hyphenate-limit-zone, 5ex, ms);
  @include the-font-size($chain-basesize);
  font-family: $chain-body-face;
}

pre, tt, code {
  font-family: $chain-mono;
  font-size: 85%;

  background-color: lighten($chain-orange, 48%);
  border-radius: 0.2rem;
  border: 1pt solid $chain-orange;
  color: $chain-black;
  padding: 0 0.1rem;
}

pre, pre.terminal {
  border: none;
  border-radius: 0;
  margin: 0;
  background-color: white;
  code {
    border: none;
    background-color: inherit;
    padding: 0;
  }
  border: 1px solid #000;
}

a {
  text-decoration: none;
  &:hover {
    text-decoration: underline;
  }
}

// DEPRECATED?
.chain-offset-left {
  margin-left: 0.5ex;
}

#page-navigation, .page-navigation {
  font-family: $chain-element-face;
}

figcaption p, .chain-caption {
  @include the-font-size($chain-sm);
}

$hsizes: (
  1: $chain-h1,
  2: $chain-h2,
  3: $chain-h3,
  4: $chain-h4,
  5: $chain-h5,
  6: $chain-h6
);

@each $i, $size in $hsizes {
  h#{$i}, .h#{$i} {
    font-weight: 700;
    text-align: left;
    @include prefixer(hyphens, auto, webkit ms moz);
    @include the-font-size($size);
    font-family: $chain-heading-face;
  }
}

.chain-pull-quote {
  blockquote {
    margin-bottom: 0;
    border-color: $chain-orange;
    p {
      font-style: italic;
      @include the-font-size($chain-h5);
      text-align: left;
      color: $chain-purple;
    }
  }
}

figcaption, .chain-copyright p {
  @include the-font-size($chain-sm);
  font-style: italic;
}

footer, .chain-vs, .chain-footnotes {
  @include the-font-size($chain-vs);
}

body, .chain-base-size {
  @include the-font-size($chain-basesize);
}
